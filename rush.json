/**
 * This is the main configuration file for Rush.
 * For full documentation, please see https://rushjs.io
 */
{
  "$schema": "https://developer.microsoft.com/json-schemas/rush/v5/rush.schema.json",

  /**
   * (Required) This specifies the version of the Rush engine to be used in this repo.
   * Rush's "version selector" feature ensures that the globally installed tool will
   * behave like this release, regardless of which version is installed globally.
   *
   * The common/scripts/install-run-rush.js automation script also uses this version.
   *
   * NOTE: If you upgrade to a new major version of Rush, you should replace the "v5"
   * path segment in the "$schema" field for all your Rush config files.  This will ensure
   * correct error-underlining and tab-completion for editors such as VS Code.
   */
  "rushVersion": "5.93.1",

  "pnpmVersion": "7.32.2",
  "nodeSupportedVersionRange": ">=16.13.0 <17.0.0 || >=18.0.0 <19.0.0",
  "ensureConsistentVersions": false,

  "repository": {
    "url": "https://github.com/fintraffic-vts/mcp-cdk",
    "defaultBranch": "master",
    "defaultRemote": "origin"
  },

  "allowedProjectTags": ["internal", "cdk", "library", "marine", "rail", "road", "other", "aviation"],

  "eventHooks": {
    /**
     * The list of shell commands to run before the Rush installation starts
     */
    "preRushInstall": ["common/scripts/run-with-zx.sh common/scripts/git-init-submodule.mjs"],

    /**
     * The list of shell commands to run after the Rush installation finishes
     */
    "postRushInstall": [],

    /**
     * The list of shell commands to run before the Rush build command starts
     */
    "preRushBuild": [],

    /**
     * The list of shell commands to run after the Rush build command finishes
     */
    "postRushBuild": []
  },

  "projects": [
    // aviation
    {
      "packageName": "aviation-data",
      "projectFolder": "aviation/aviation-data",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "aviation"]
    },

    // libraries
    {
      "packageName": "@digitraffic/common",
      "projectFolder": "lib/digitraffic-common",
      "versionPolicyName": "DigitrafficCommon",
      "tags": ["library"]
    },

    // marine
    {
      "packageName": "aton-faults",
      "projectFolder": "marine/aton-faults",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "bridge-lock-disruptions",
      "projectFolder": "marine/bridge-lock-disruptions",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "gofrep",
      "projectFolder": "marine/gofrep",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "marinecam",
      "projectFolder": "marine/marinecam",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "nautical-warnings",
      "projectFolder": "marine/nautical-warnings",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "portactivity",
      "projectFolder": "marine/portactivity",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "shiplight",
      "projectFolder": "marine/shiplight",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "sse-sea-state-estimate",
      "projectFolder": "marine/sse",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },
    {
      "packageName": "voyage-plan-gateway",
      "projectFolder": "marine/voyage-plan-gateway",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "marine"]
    },

    // other
    {
      "packageName": "digitraffic-aws-github-oidc",
      "projectFolder": "other/aws-github-oidc",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "cloudfront",
      "projectFolder": "other/cloudfront",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "cloudwatch-logs-recipient",
      "projectFolder": "other/cloudwatch-logs-recipient",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "digitraffic-statistics",
      "projectFolder": "other/digitraffic-statistics",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "elasticsearch",
      "projectFolder": "other/elasticsearch",
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "es-key-figures",
      "projectFolder": "other/es-key-figures",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "monitoring",
      "projectFolder": "other/monitoring",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "opensearch-monitors",
      "projectFolder": "other/opensearch-monitors",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "patchmanager-cdk",
      "projectFolder": "other/patchmanager",
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "status-cdk",
      "projectFolder": "other/status",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },
    {
      "packageName": "swagger-joiner",
      "projectFolder": "other/swagger-joiner",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "other"]
    },

    // rail
    {
      "packageName": "rail-rata-cdk",
      "projectFolder": "rail/rata",
      "tags": ["cdk", "rail"]
    },
    {
      "packageName": "rami",
      "projectFolder": "rail/rami",
      "tags": ["cdk", "rail"]
    },

    // road
    {
      "packageName": "counting-sites",
      "projectFolder": "road/counting-site",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "lam-history",
      "projectFolder": "road/lam-history",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "maintenance-tracking",
      "projectFolder": "road/maintenance-tracking",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "maintenance-tracking-watch",
      "projectFolder": "road/maintenance-tracking-log-watcher",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "maintenance-tracking-municipality",
      "projectFolder": "road/maintenance-tracking-municipality",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "open311-cdk",
      "projectFolder": "road/open311",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "road-network-conditions",
      "projectFolder": "road/road-network-conditions",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "street-traffic-messages",
      "projectFolder": "road/street-traffic-message",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },
    {
      "packageName": "variable-signs",
      "projectFolder": "road/variable-signs",
      "decoupledLocalDependencies": ["@digitraffic/common"],
      "tags": ["cdk", "road"]
    },

    // internal / tools
    {
      "packageName": "@digitraffic-cdk/eslint-config",
      "projectFolder": "tools/eslint-config",
      "tags": ["internal"]
    },
    {
      "packageName": "@digitraffic-cdk/digitraffic-cdk-rig",
      "projectFolder": "tools/rig",
      "tags": ["internal"]
    },
    {
      "packageName": "@digitraffic-cdk/toolchain",
      "projectFolder": "tools/toolchain",
      "tags": ["internal"]
    }
  ]
}
